var Context,Predict,Tag;Tag=require("./tags/tag").Tag,Predict=require("./tags/predict").Predict,exports.Context=Context=function(){function t(t,e,n,r){this.options=null!=t?t:{},this.indentToken=null!=e?e:"  ",this.newlineToken=null!=n?n:"\n",this.defaultLevel=null!=r?r:0,this.result=[],this.tagTypes={},this.predictTypes={}}return t.prototype.sub=function(e){var n;return n=new t(this.options,this.indentToken,this.newlineToken,e||this.defaultLevel),n.tagTypes=this.tagTypes,n.predictTypes=this.predictTypes,n},t.prototype.getIndent=function(t){var e,n,r,i;for(n="",e=r=0,i=t+this.defaultLevel;i>=0?i>r:r>i;e=i>=0?++r:--r)n+=this.indentToken;return n},t.prototype.indent=function(t){return this.result.push(this.getIndent(t)),this},t.prototype.eol=function(){return this.result.push(this.newlineToken),this},t.prototype.push=function(t){return this.result.push(t),this},t.prototype.pop=function(){return this.result.pop(),this},t.prototype.last=function(t){return this.result.slice(-t)},t.prototype.registerTag=function(t,e){return this.tagTypes[t]=e,this},t.prototype.registerPredict=function(t,e){return this.predictTypes[t]=e,this},t.prototype.createTag=function(t,e){var n,r;return r=t.name,new(n=this.tagTypes[r]||Tag)(t,e)},t.prototype.createPredict=function(t,e,n){var r;return new(r=this.predictTypes[t]||Predict)(e,n)},t.prototype.generate=function(t){var e,n,r,i,s;for(s=[],r=0,i=t.length;i>r;r++)e=t[r],n=this.createTag(e),s.push(n.generate(this));return s},t.prototype.getOutput=function(){return this.result.join("")},t}();